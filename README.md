# laravel-cheat-sheet

## Route

	Пример: http://example.com/articles

### Define route

```php
// Регистрация GET-маршрута с использованием замыкания
Route::get('/articles', function(){});

// Регистрация GET-маршрута с использованием контроллера
Route::get('/articles', 'ArticleController@index');
Route::get('/articles', [ArticleController::class, 'index']);
```

### Route Parameter

```php
// Передача числового ID статьи в переменную $id.
Route::get('/articles/{article}', function ($id) {return 'article '. $id;});

// Передача числового ID статьи в переменную $articleId, ID комментария в переменную $commentId
Route::get('/articles/{article}/comments/{comment}', function ($articleId, $commentId) {});
```

### Optional parameters

```php
// по умолчанию для $name используется значение null
Route::get('/articles/{name?}', function ($name = null) {return $name;});

// по умолчанию 'Alex' в $name
Route::get('/articles/{name?}', function ($name = 'Alex') {return $name;});
```

	Для использования опционального параметра необходимо указать значение параметров по умолчанию
### HTTP Verbs

```php
// Опции для определения доступных http методов
Route::options('/articles', function() {});

// Получение данных с сервера
Route::get('/articles', function() {});

// Отправка данных на сервер
Route::post('/articles', function() {});

//  Обновление существующего ресурса
Route::put('/articles', function() {});

// Частичное обновление ресурса
Route::patch('/articles', function() {});

//  Удаление ресурса.
Route::delete('/articles', function() {});

// Ответ на любой тип запроса
Route::any('/articles', function() {});
```

### RESTful Controllers

```php
// Определение ресурсных маршрутов
Route::resource('/articles','ArticleController');

// Частичное определение ресурсных маршрутов
	// only - позволяет определить белый список экшенов, которые доступны по данному роуту
Route::resource('/articles', 'ArticleController',['only' => ['index', 'show']]);
	// except - определяет черный список экшенов, которые недоступны по данному роуту
Route::resource('/articles', 'ArticleController',['except' => ['edit', 'update', 'destroy']]);
```

## Eloquent

Вот обновленная таблица с добавленными недостающими методами:

| Группа | Метод | Описание |
|-|-|-|
| Получение записей | all() | Получить все записи модели |
|  | chunk() | Получить записи модели порциями |
|  | find() | Найти запись по первичному ключу |  
|  | first() | Получить первую запись |
|  | firstOrCreate() | Получить первую запись или создать новую |
|  | firstOrFail() | Получить первую запись или вызвать исключение |
|  | firstOrNew() | Получить первую запись или новый экземпляр | 
|  | firstWhere() | Получить первую запись по условию |
|  | get() | Получить записи по первичному ключу или массиву ключей |
|  | inRandomOrder() | Получить записи в случайном порядке |
|  | latest() | Получить последнюю запись |
|  | oldest() | Получить самую старую запись |
|  | paginate() | Получить записи с постраничной разбивкой |
|  | sole() | Получить одну запись или вызвать исключение | 
|  | take() | Получить указанное количество записей |
|  | where() | Фильтрация записей |  
|  | whereBetween() | Фильтрация между значениями |
|  | whereIn() | Фильтрация по массиву значений |
|  | whereNotBetween() | Исключить значения между |  
|  | whereNotIn() | Исключить значения из массива |
|  | whereNull() | Фильтрация по NULL значению |
| Вставка/обновление | create() | Создать и сохранить новую запись |  
|  | forceDelete() | Принудительно удалить запись |
|  | insert() | Вставить запись в таблицу |
|  | make() | Создать новый экземпляр модели |
|  | save() | Сохранить запись |
|  | update() | Обновить существующую запись |
|  | updateOrCreate() | Обновить или создать запись |
| Удаление | delete() | Удалить запись |
|  | destroy() | Удалить запись и связанные |  
|  | forceDelete() | Принудительно удалить запись | 
|  | restore() | Восстановить удаленную запись |
|  | trashed() | Получить только удаленные записи |
| Агрегация | avg() | Получить среднее значение столбца |
|  | count() | Получить количество записей |  
|  | max() | Получить максимальное значение столбца |
|  | min() | Получить минимальное значение столбца |
|  | sum() | Получить сумму значений столбца |
| Отношения | attach() | Присоединить связанную модель | 
|  | belongsTo() | Определить отношение "принадлежит" |
|  | belongsToMany() | Определить многие-ко-многим |
|  | hasOne() | Определить отношение "имеет один" |
|  | hasMany() | Определить отношение "имеет много" |
|  | morphMany() | Полиморфное отношение "имеет много" |
|  | morphOne() | Полиморфное отношение "имеет один" |
|  | morphTo() | Определить полиморфное отношение |
|  | morphToMany() | Полиморфное многие-ко-многим | 
|  | sync() | Синхронизировать связи |
| Коллекции | each() | Выполнить функцию для каждого элемента |
|  | filter() | Фильтрация коллекции | 
|  | map() | Применить функцию к каждому элементу |
|  | mapInto() | Применить функцию и добавить в коллекцию |
|  | mapSpread() | Распаковать коллекцию в массив |
|  | reject() | Фильтрация по условию |
|  | sortBy() | Сортировка коллекции |
|  | sortByDesc() | Сортировка коллекции по убыванию |
|  | unique() | Убрать дубликаты из коллекции |
|  | values() | Получить все значения коллекции |
| Другое | decrement() | Уменьшить числовое значение |
|  | detach() | Удалить связь с родительской моделью |  
|  | increment() | Увеличить числовое значение |
|  | onlyTrashed() | Получить только удаленные модели |
|  | pluck() | Получить значения указанного столбца |
|  | push() | Добавить элемент в массив |
|  | saveMany() | Сохранить коллекцию моделей |  
|  | toBase() | Преобразовать к первоначальному состоянию |
|  | toSql() | Получить SQL запрос модели |
|  | with() | Добавить дополнительные условия | 
|  | withAggregate() | Добавить агрегатную функцию |
|  | withCount() | Добавить подсчет связанных моделей |